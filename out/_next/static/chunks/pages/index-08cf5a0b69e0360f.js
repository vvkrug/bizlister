(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(1743)}])},1743:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return pages}});var n=a(5893),s=a(7294);let l=(0,s.createContext)(void 0),reducer=(e,t)=>{switch(t.type){case"ADD_COMPANY":return{...e,companies:[...e.companies,t.payload]};case"DELETE_COMPANY":return{...e,companies:e.companies.filter(e=>e.id!==t.payload)};case"EDIT_COMPANY":return{...e,companies:e.companies.map(e=>e.id===t.payload.id?{...e,address:t.payload.address}:e)};case"INITIALIZE_COMPANIES":return{...e,companies:t.payload};default:throw Error("Unhandled action type")}},CompanyProvider=e=>{let{children:t}=e,[a,o]=(0,s.useReducer)(reducer,{companies:[]});return(0,s.useEffect)(()=>{{let e=localStorage.getItem("companies");e&&o({type:"INITIALIZE_COMPANIES",payload:JSON.parse(e)})}},[]),(0,n.jsx)(l.Provider,{value:{state:a,dispatch:o},children:t})},useCompanies=()=>{let e=(0,s.useContext)(l);if(void 0===e)throw Error("useCompanies must be used within a CompanyProvider");return e};var o=a(89),r=a(6154);let i=r.Z.create({baseURL:"https://suggestions.dadata.ru/suggestions/api/4_1/rs/findById/party",headers:{Authorization:"Token 80cd8380abc5a408adeae18d0096cac437797800",Accept:"application/json","Content-Type":"application/json"}}),getCompanyInfoByINN=async e=>{try{let t=await i.post("",{query:e});return t.data.suggestions[0]}catch(e){throw console.error("Ошибка при получении данных от DaData:",e),e}};var components_Modal=e=>{let{isOpen:t,onClose:a,onAdd:l}=e,[r,i]=(0,s.useState)({name:"",address:"",ogrn:"",inn:"",registrationDate:""}),handleLoad=async()=>{try{let e=await getCompanyInfoByINN(r.inn),t=new Date(e.data.state.registration_date).toLocaleDateString("en-GB");i({name:e.value,address:e.data.address.value,ogrn:e.data.ogrn,inn:e.data.inn,registrationDate:t})}catch(e){console.error("Ошибка при загрузке данных:",e)}};return(0,s.useEffect)(()=>{if(t){var e;null===(e=document.getElementById("name"))||void 0===e||e.focus()}},[t]),t?(0,n.jsx)("div",{className:"fixed inset-0 z-50 overflow-auto bg-smoke-light flex items-center justify-center",onClick:e=>{e.target===e.currentTarget&&a()},children:(0,n.jsx)(o.E.div,{initial:{opacity:0,scale:.7},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.7},className:"modal-content",children:(0,n.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,n.jsx)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center",children:(0,n.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,n.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"name",children:"Наименование"}),(0,n.jsx)("input",{type:"text",id:"name",value:r.name,onChange:e=>i({...r,name:e.target.value}),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"name",children:"Адрес"}),(0,n.jsx)("input",{type:"text",id:"address",value:r.address,onChange:e=>i({...r,address:e.target.value}),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"name",children:"ОГРН"}),(0,n.jsx)("input",{type:"text",id:"ogrn",value:r.ogrn,onChange:e=>i({...r,ogrn:e.target.value}),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"})]}),(0,n.jsxs)("div",{className:"flex mb-4 items-center",children:[(0,n.jsx)("label",{className:"block text-gray-700 text-sm font-bold",htmlFor:"inn",children:"ИНН"}),(0,n.jsx)("input",{type:"text",id:"inn",value:r.inn,onChange:e=>i({...r,inn:e.target.value}),className:"mx-2 shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"}),(0,n.jsx)("button",{onClick:handleLoad,className:"px-4 py-2 font-bold text-white bg-blue-500 rounded-full hover:bg-blue-700 focus:outline-none",children:"Загрузить"})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",htmlFor:"name",children:"Дата регистрации"}),(0,n.jsx)("input",{type:"text",id:"registrationDate",value:r.registrationDate,onChange:e=>i({...r,registrationDate:e.target.value}),className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline"})]})]}),(0,n.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,n.jsx)("button",{onClick:()=>{l({...r}),a()},type:"submit",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Добавить"}),(0,n.jsx)("button",{onClick:a,type:"button",className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Отмена"})]})]})})})})}):null},components_AddButton=()=>{let[e,t]=(0,s.useState)(!1),{dispatch:a}=useCompanies();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{onClick:()=>t(!0),className:"px-4 py-2 bg-blue-500 text-white rounded w-full",children:"Добавить"}),e&&(0,n.jsx)(components_Modal,{isOpen:e,onClose:()=>t(!1),onAdd:e=>{a({type:"ADD_COMPANY",payload:{id:Date.now(),...e}})}})]})},components_Table=()=>{let{state:e,dispatch:t}=useCompanies(),[a,l]=(0,s.useState)(null),[o,r]=(0,s.useState)(""),handleDelete=e=>{t({type:"DELETE_COMPANY",payload:e})},handleEdit=(e,t)=>{l(e),r(t)},handleBlur=e=>{t({type:"EDIT_COMPANY",payload:{id:e,address:o}}),l(null)};return(0,n.jsxs)("table",{className:"min-w-full bg-white",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"py-2",children:"Наименование"}),(0,n.jsx)("th",{className:"py-2",children:"Адрес"}),(0,n.jsx)("th",{className:"py-2",children:"ОГРН"}),(0,n.jsx)("th",{className:"py-2",children:"ИНН"}),(0,n.jsx)("th",{className:"py-2",children:"Дата регистрации"}),(0,n.jsx)("th",{className:"py-2",children:"Действия"})]})}),(0,n.jsx)("tbody",{children:e.companies.map(e=>(0,n.jsxs)("tr",{className:"".concat(e.id%2==0?"bg-gray-100":""),children:[(0,n.jsx)("td",{className:"py-2 text-center",children:e.name}),(0,n.jsx)("td",{className:"py-2 text-center",children:a===e.id?(0,n.jsx)("input",{type:"text",value:o,onChange:e=>r(e.target.value),onBlur:()=>handleBlur(e.id),autoFocus:!0,className:"w-full"}):(0,n.jsx)("span",{onClick:()=>handleEdit(e.id,e.address),children:e.address})}),(0,n.jsx)("td",{className:"py-2 text-center",children:e.ogrn}),(0,n.jsx)("td",{className:"py-2 text-center",children:e.inn}),(0,n.jsx)("td",{className:"py-2 text-center",children:e.registrationDate}),(0,n.jsx)("td",{className:"py-2 text-center",children:(0,n.jsx)("button",{onClick:()=>handleDelete(e.id),children:"Удалить"})})]},e.id))})]})},pages=()=>(0,n.jsx)(CompanyProvider,{children:(0,n.jsxs)("div",{className:"container mx-auto p-6",children:[(0,n.jsx)(components_AddButton,{}),(0,n.jsx)(components_Table,{})]})})}},function(e){e.O(0,[394,774,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);